/*================================================================
	ORC_JS, JavaScript Class Framework
 	version:3.00.71113
	Copyright 2007 by SourceTec Software Co.,LTD
	For more information, see:www.sothink.com
================================================================*/
if(typeof _STNS!="undefined"&&_STNS.UI&&!_STNS.UI.CUICanvas){with(_STNS.UI){_STNS.UI.CUICanvas=_STNS.Class(_STNS.UI.CUIObj);CUICanvas.register("UI/CUIObj>CUICanvas");CUICanvas.construct=function(){this._iStartPt=[0,0];this.aItems=[];this.iIdNo=0;this.iStat=0;this.dmWin=window;with(_STNS.UI.CUICanvas){this.fsGetEid=fsGetEid;this.fbInit=fbInit;this._fvMsDown=_fvMsDown;this._fvMsUp=_fvMsUp;this._fvResize=_fvResize;this.fvSetCursor=fvSetCursor;this.fbInsItem=fbInsItem;this.fbDelItem=fbDelItem;this.faGetItemsInRect=faGetItemsInRect;this.foGetItemByEid=foGetItemByEid;this.fsGetEnt=fsGetEnt;}};CUICanvas.fvSetCursor=function(){};CUICanvas.fsGetEnt=function(o,t,n){return _STNS.UI.fsGetEnt(o,t,n);};CUICanvas.foGetItemByEid=function(_4){var o;while(_4){if(o=this.aItems[_4]){return o;}_4=_4.substr(0,_4.lastIndexOf("_"));}};CUICanvas.fbInit=function(){var _r=_STNS,c,_8=this.dmWin.document,t=this;_8.onselectstart=function(){if(event.srcElement.tagName=="INPUT"){return true;}return false;};_8.onmousedown=function(e){t._fvMsDown(e);return true;};_8.onmouseup=function(e){t._fvMsUp(e);return true;};onresize=function(e){t._fvResize(e);};return true;};CUICanvas.fsGetEid=function(){this.iIdNo++;return this.iIdNo;};CUICanvas.faGetItemsInRect=function(r){var es=[];for(var i in this.aItems){if(this.aItems[i].fbIsIn(r)){es.push(this.aItems[i]);}}return es;};CUICanvas._fvMsDown=function(e){var _r=_STNS,_c=_STNS.UI.CUICanvas,se;if(!e){e=this.dmWin.event;}if(_STNS.bIsIE){se=e.srcElement;}else{se=e.target;}if(se.tagName=="BODY"||se.tagName=="HTML"){if(!(this.iStat&_c.EDITING)){for(var i in this.aItems){if(this.aItems[i].fvGetMsg){this.aItems[i].fvGetMsg("CLEAR_ALL");}}this.fbFireEnt("clearall");}this.iStat|=_c.MOUSEDOWN;}};CUICanvas._fvMsUp=function(e){var _r=_STNS,_c=_STNS.UI.CUICanvas;if(!e){e=this.dmWin.event;}if(_STNS.bIsIE){se=e.srcElement;}else{se=e.target;}if((this.iStat&_c.MOUSEDOWN)&&(se.tagName=="BODY"||se.tagName=="HTML")){this.iStat&=_c.MAXSTATE-_c.MOUSEDOWN;}};CUICanvas._fvResize=function(e){var _r=_STNS,_c=_STNS.UI.CUICanvas;if(!e){e=this.dmWin.event;}return this.fbFireEnt("resize");};CUICanvas.fbInsItem=function(_1b){_1b.iEid=this.fsGetEid();this.aItems[_1b.iEid]=_1b;_1b.oParCanvas=this;};CUICanvas.fbDelItem=function(i){if(this.aItems[i]){this.aItems[i].iEid=0;this.aItems[i].oParCanvas=0;delete this.aItems[i];}};CUICanvas.DRAGING=1;CUICanvas.MOUSEDOWN=2;CUICanvas.EDITING=4;with(CUICanvas){CUICanvas.MAXSTATE=DRAGING|MOUSEDOWN|EDITING;}_STNS.UI.CUIEditElement=_STNS.Class(_STNS.UI.CUIObj);CUIEditElement.register("UI/CUIObj>CUIEditElement");CUIEditElement.construct=function(){this.iEid=0;this.oParCanvas=0;with(_STNS.UI.CUIEditElement){this.fbIsIn=fbIsIn;this.fvDestroy=fvDestroy;}};CUIEditElement.fbIsIn=_STNS.fbFalse;CUIEditElement.fvDestroy=function(){if(this.oParCanvas){this.oParCanvas.fbDelItem(this.iEid);}_STNS.UI.CUIObj.fvDestroy.call(this);};_STNS.UI.CUIEditRect=_STNS.Class(_STNS.UI.CUIEditElement);CUIEditRect.register("UI/CUIEditElement>CUIEditRect");CUIEditRect.construct=function(){this.iMQStyle=0;this.iMQWid=0;this.iMQHei=0;this.iMQPos=[0,0];with(_STNS.UI.CUIEditRect){this.fbSetMarqueeWid=fbSetMarqueeWid;this.fbSetMarqueeHei=fbSetMarqueeHei;this.fbSetMarqueePos=fbSetMarqueePos;this.fbShowMarquee=fbShowMarquee;this.fbHideMarquee=fbHideMarquee;this.fbCreate=fbCreate;this.fbInit=fbInit;this.fbFlickerMarquee=fbFlickerMarquee;this.fbSetMQCursor=fbSetMQCursor;}};CUIEditRect.fbSetMQCursor=function(cur){if(!cur){return;}var _r=_STNS,c=this.oParCanvas,e,_c=_r.UI.CUIEditRect;if(e=_r.fdmGetEleById(this.sUid+"_em",c.dmWin)){e.style.cursor=cur;}};CUIEditRect.fbSetMarqueeWid=function(w){var _r=_STNS,c=this.oParCanvas,e,_c=_r.UI.CUIEditRect;if(!c){return;}if(e=_r.fdmGetEleById(this.sUid+"_em",c.dmWin)){this.iMQWid=w;e.style.width=w+(_STNS.bIsIE?2:0)+"px";if((this.iMQStyle&_c.SHOW_NORTH)&&(e=_r.fdmGetEleById(this.sUid+"_en",c.dmWin))){e.style.left=this.iMQPos[0]+parseInt((this.iMQWid)/2)-3+"px";}if((this.iMQStyle&_c.SHOW_NORTHEAST)&&(e=_r.fdmGetEleById(this.sUid+"_ene",c.dmWin))){e.style.left=this.iMQPos[0]+this.iMQWid-3+"px";}if((this.iMQStyle&_c.SHOW_EAST)&&(e=_r.fdmGetEleById(this.sUid+"_ee",c.dmWin))){e.style.left=this.iMQPos[0]+this.iMQWid-3+"px";}if((this.iMQStyle&_c.SHOW_SOUTHEAST)&&(e=_r.fdmGetEleById(this.sUid+"_ese",c.dmWin))){e.style.left=this.iMQPos[0]+this.iMQWid-3+"px";}if((this.iMQStyle&_c.SHOW_SOUTH)&&(e=_r.fdmGetEleById(this.sUid+"_es",c.dmWin))){e.style.left=this.iMQPos[0]+parseInt((this.iMQWid)/2)-3+"px";}}};CUIEditRect.fbSetMarqueeHei=function(h){var _r=_STNS,c=this.oParCanvas,e,_c=_r.UI.CUIEditRect;if(!c){return false;}if(e=_r.fdmGetEleById(this.sUid+"_em",c.dmWin)){this.iMQHei=h;e.style.height=h+(_STNS.bIsIE?2:0)+"px";if((this.iMQStyle&_c.SHOW_EAST)&&(e=_r.fdmGetEleById(this.sUid+"_ee",c.dmWin))){e.style.top=this.iMQPos[1]+((this.iMQHei)/2)-3+"px";}if((this.iMQStyle&_c.SHOW_SOUTHEAST)&&(e=_r.fdmGetEleById(this.sUid+"_ese",c.dmWin))){e.style.top=this.iMQPos[1]+this.iMQHei-3+"px";}if((this.iMQStyle&_c.SHOW_SOUTH)&&(e=_r.fdmGetEleById(this.sUid+"_es",c.dmWin))){e.style.top=this.iMQPos[1]+this.iMQHei-3+"px";}if((this.iMQStyle&_c.SHOW_SOUTHWEST)&&(e=_r.fdmGetEleById(this.sUid+"_ese",c.dmWin))){e.style.top=this.iMQPos[1]+this.iMQHei-3+"px";}if((this.iMQStyle&_c.SHOW_WEST)&&(e=_r.fdmGetEleById(this.sUid+"_es",c.dmWin))){e.style.top=this.iMQPos[1]+parseInt((this.iMQHei)/2)-3+"px";}}};CUIEditRect.fbSetMarqueePos=function(p){var _r=_STNS,c=this.oParCanvas,e,_c=_r.UI.CUIEditRect;if(!c){return false;}if(e=_r.fdmGetEleById(this.sUid+"_em",c.dmWin)){this.iMQPos=p;e.style.left=p[0]-1+"px";e.style.top=p[1]-1+"px";if((this.iMQStyle&_c.SHOW_NORTHWEST)&&(e=_r.fdmGetEleById(this.sUid+"_enw",c.dmWin))){e.style.left=this.iMQPos[0]-3+"px";e.style.top=this.iMQPos[1]-3+"px";}if((this.iMQStyle&_c.SHOW_NORTH)&&(e=_r.fdmGetEleById(this.sUid+"_en",c.dmWin))){e.style.left=this.iMQPos[0]+parseInt(this.iMQWid/2)-3+"px";e.style.top=this.iMQPos[1]-3+"px";}if((this.iMQStyle&_c.SHOW_NORTHEAST)&&(e=_r.fdmGetEleById(this.sUid+"_ene",c.dmWin))){e.style.left=this.iMQPos[0]+this.iMQWid-3+"px";e.style.top=this.iMQPos[1]-3+"px";}if((this.iMQStyle&_c.SHOW_EAST)&&(e=_r.fdmGetEleById(this.sUid+"_ee",c.dmWin))){e.style.left=this.iMQPos[0]+this.iMQWid-3+"px";e.style.top=this.iMQPos[1]+parseInt(this.iMQHei/2)-3+"px";}if((this.iMQStyle&_c.SHOW_SOUTHEAST)&&(e=_r.fdmGetEleById(this.sUid+"_ese",c.dmWin))){e.style.left=this.iMQPos[0]+this.iMQWid-3+"px";e.style.top=this.iMQPos[1]+this.iMQHei-3+"px";}if((this.iMQStyle&_c.SHOW_SOUTH)&&(e=_r.fdmGetEleById(this.sUid+"_es",c.dmWin))){e.style.left=this.iMQPos[0]+parseInt(this.iMQWid/2)-3+"px";e.style.top=this.iMQPos[1]+this.iMQHei-3+"px";}if((this.iMQStyle&_c.SHOW_SOUTHWEST)&&(e=_r.fdmGetEleById(this.sUid+"_esw",c.dmWin))){e.style.left=this.iMQPos[0]-3+"px";e.style.top=this.iMQPos[1]+this.iMQHei-3+"px";}if((this.iMQStyle&_c.SHOW_WEST)&&(e=_r.fdmGetEleById(this.sUid+"_ew",c.dmWin))){e.style.left=this.iMQPos[0]-3+"px";e.style.top=this.iMQPos[1]+parseInt(this.iMQHei/2)-3+"px";}}};CUIEditRect.fbCreate=function(){var s,_c=_STNS.UI.CUIEditRect,c=this.oParCanvas;with(this){if(!c){return false;}s="<div style='font-size:1pt;position:absolute;top:0px;left:0px;z-index:4500;width:100px;height:100px;display:none;border:1px dashed blue;'"+"id='"+sUid+"_em' "+c.fsGetEnt(this,"mouseover","")+" "+c.fsGetEnt(this,"mouseout","")+" "+c.fsGetEnt(this,"mousemove","")+" "+c.fsGetEnt(this,"mouseup","")+" "+c.fsGetEnt(this,"mousedown","")+" "+c.fsGetEnt(this,"keypress","")+" "+c.fsGetEnt(this,"keydown","")+" "+c.fsGetEnt(this,"keyup","")+" "+c.fsGetEnt(this,"click","")+" "+c.fsGetEnt(this,"dblclick","")+">"+"<div style='font-size:1pt;background-color:white;filter:Alpha(opacity=0);-moz-opacity:0;width:100%;height:100%;'>"+"</div>"+"</div>"+(iMQStyle&_c.SHOW_NORTHWEST?"<div id='"+sUid+"_enw' style='font-size:1pt;background-color:white;position:absolute;top:0px;left:0px;z-index:4501;width:6px;height:6px;cursor:NW-resize;display:none;border:1px solid blue;'></div>":"")+(iMQStyle&_c.SHOW_NORTH?"<div id='"+sUid+"_en' style='font-size:1pt;background-color:white;position:absolute;top:0px;left:0px;z-index:4501;width:6px;height:6px;cursor:N-resize;display:none;border:1px solid blue;'></div>":"")+(iMQStyle&_c.SHOW_NORTHEAST?"<div  id='"+sUid+"_ene' style='font-size:1pt;background-color:white;position:absolute;top:0px;left:0px;z-index:4501;width:6px;height:6px;cursor:NE-resize;display:none;border:1px solid blue;'></div>":"")+(iMQStyle&_c.SHOW_EAST?"<div id='"+sUid+"_ee' style='font-size:1pt;background-color:white;position:absolute;top:0px;left:0px;z-index:4501;width:6px;height:6px;cursor:E-resize;display:none;border:1px solid blue;'></div>":"")+(iMQStyle&_c.SHOW_SOUTHEAST?"<div id='"+sUid+"_ese' style='font-size:1pt;background-color:white;position:absolute;top:0px;left:0px;z-index:4501;width:6px;height:6px;cursor:SE-resize;display:none;border:1px solid blue;'></div>":"")+(iMQStyle&_c.SHOW_SOUTH?"<div id='"+sUid+"_es' style='font-size:1pt;background-color:white;position:absolute;top:0px;left:0px;z-index:4501;width:6px;height:6px;cursor:S-resize;display:none;border:1px solid blue;'></div>":"")+(iMQStyle&_c.SHOW_SOUTHWEST?"<div id='"+sUid+"_esw' style='font-size:1pt;background-color:white;position:absolute;top:0px;left:0px;z-index:4501;width:6px;height:6px;cursor:SW-resize;display:none;border:1px solid blue;'></div>":"")+(iMQStyle&_c.SHOW_WEST?"<div id='"+sUid+"_ew' style='font-size:1pt;background-color:white;position:absolute;top:0px;left:0px;z-index:4501;width:6px;height:6px;cursor:W-resize;display:none;border:1px solid blue;'></div>":"");_STNS.fbInsHTML(document.body,"afterBegin",s);}};CUIEditRect.fbShowMarquee=function(){var _r=_STNS,e,c=this.oParCanvas,_c=_r.UI.CUIEditRect;if(!c){return false;}if(e=_r.fdmGetEleById(this.sUid+"_em",c.dmWin)){e.style.display="";if((this.iMQStyle&_c.SHOW_NORTHWEST)&&(e=_r.fdmGetEleById(this.sUid+"_enw",c.dmWin))){e.style.display="";}if((this.iMQStyle&_c.SHOW_NORTH)&&(e=_r.fdmGetEleById(this.sUid+"_en",c.dmWin))){e.style.display="";}if((this.iMQStyle&_c.SHOW_NORTHEAST)&&(e=_r.fdmGetEleById(this.sUid+"_ene",c.dmWin))){e.style.display="";}if((this.iMQStyle&_c.SHOW_EAST)&&(e=_r.fdmGetEleById(this.sUid+"_ee",c.dmWin))){e.style.display="";}if((this.iMQStyle&_c.SHOW_SOUTHEAST)&&(e=_r.fdmGetEleById(this.sUid+"_ese",c.dmWin))){e.style.display="";}if((this.iMQStyle&_c.SHOW_SOUTH)&&(e=_r.fdmGetEleById(this.sUid+"_es",c.dmWin))){e.style.display="";}if((this.iMQStyle&_c.SHOW_SOUTHWEST)&&(e=_r.fdmGetEleById(this.sUid+"_esw",c.dmWin))){e.style.display="";}if((this.iMQStyle&_c.SHOW_WEST)&&(e=_r.fdmGetEleById(this.sUid+"_ew",c.dmWin))){e.style.display="";}}};CUIEditRect.fbFlickerMarquee=function(n){var _r=_STNS,c=this.oParCanvas,e,_c=_r.UI.CUIEditRect;if(!c){return false;}if(!n){n=0;}if(e=_r.fdmGetEleById(this.sUid+"_em",c.dmWin)){if(n%2){e.style.borderWidth="2px";}else{e.style.borderWidth="1px";}if(n<6){setTimeout(this.sSelf+".fbFlickerMarquee("+(++n)+")",150);}}return true;};CUIEditRect.fbHideMarquee=function(){var _r=_STNS,c=this.oParCanvas,e,_c=_r.UI.CUIEditRect;if(!c){return false;}if(e=_r.fdmGetEleById(this.sUid+"_em",c.dmWin)){e.style.display="none";if((this.iMQStyle&_c.SHOW_NORTHWEST)&&(e=_r.fdmGetEleById(this.sUid+"_enw",c.dmWin))){e.style.display="none";}if((this.iMQStyle&_c.SHOW_NORTH)&&(e=_r.fdmGetEleById(this.sUid+"_en",c.dmWin))){e.style.display="none";}if((this.iMQStyle&_c.SHOW_NORTHEAST)&&(e=_r.fdmGetEleById(this.sUid+"_ene",c.dmWin))){e.style.display="none";}if((this.iMQStyle&_c.SHOW_EAST)&&(e=_r.fdmGetEleById(this.sUid+"_ee",c.dmWin))){e.style.display="none";}if((this.iMQStyle&_c.SHOW_SOUTHEAST)&&(e=_r.fdmGetEleById(this.sUid+"_ese",c.dmWin))){e.style.display="none";}if((this.iMQStyle&_c.SHOW_SOUTH)&&(e=_r.fdmGetEleById(this.sUid+"_es",c.dmWin))){e.style.display="none";}if((this.iMQStyle&_c.SHOW_SOUTHWEST)&&(e=_r.fdmGetEleById(this.sUid+"_esw",c.dmWin))){e.style.display="none";}if((this.iMQStyle&_c.SHOW_WEST)&&(e=_r.fdmGetEleById(this.sUid+"_ew",c.dmWin))){e.style.display="none";}}};CUIEditRect.fbInit=_STNS.fbFalse;CUIEditRect.SHOW_NORTHWEST=1;CUIEditRect.SHOW_NORTH=2;CUIEditRect.SHOW_NORTHEAST=4;CUIEditRect.SHOW_EAST=8;CUIEditRect.SHOW_SOUTHEAST=16;CUIEditRect.SHOW_SOUTH=32;CUIEditRect.SHOW_SOUTHWEST=64;CUIEditRect.SHOW_WEST=128;}}if(typeof _STNS!="undefined"&&_STNS.UI&&_STNS.UI.CUIMenu&&_STNS.UI.CUIEditRect&&!_STNS.UI.CUIEditMenu){with(_STNS.UI){_STNS.UI.CUIEditMenu=_STNS.Class(_STNS.UI.CUIMenu);CUIEditMenu.register("UI/CUIMenu>CUIEditMenu");CUIEditMenu.construct=function(){this.oSelect={};this.oEdit=null;this.oParCanvas=null;with(_STNS.UI.CUIEditMenu){this.fbShow=fbShow;this.fbOnBlurInBox=fbOnBlurInBox;this.fbOnKeyPressInBox=fbOnKeyPressInBox;this.fbHideInBox=fbHideInBox;this.fbShowInBox=fbShowInBox;this.fsGetInBoxValue=fsGetInBoxValue;this.fbSetMsg("EDIT_NODE",fbOnEditNode);this.fbSetMsg("SELECT_NODE",fbOnSelectNode);this.fbSetMsg("CLEAR_ALL",fbOnClearAll);}};CUIEditMenu.fbShow=function(){var bg=this.sBlank.replace("blank.gif","inbox_bg.gif");var s="<div style='background-image:url("+bg+");padding:5px;visibility:hidden;position:absolute;top:0px;left:0px;z-index:5000;'"+"id='"+this.sUid+"_inbox'>"+"<input style='border:1px solid black;' "+"onblur=\"return "+this.sSelf+".fbOnBlurInBox()\" "+"onkeypress=\"return "+this.sSelf+".fbOnKeyPressInBox(event)\">"+"</div>";document.write(s);return _STNS.UI.CUIMenu.fbShow.call(this);};CUIEditMenu.fbOnBlurInBox=function(){return this.fbFireEnt("blurinbox");};CUIEditMenu.fbOnKeyPressInBox=function(e){if(e.keyCode==13){return this.fbFireEnt("enterinbox");}return true;};CUIEditMenu.fbOnClearAll=function(){this.oEdit=null;for(var i in this.oSelect){this.oSelect[i].fbHideMarquee();delete this.oSelect[i];}for(var i=0;i<this.aPopups[0].aItems.length;i++){if(this.aPopups[0].aItems[i].oSubPopup){this.aPopups[0].aItems[i].oSubPopup.fbHide();}}};CUIEditMenu.fbOnEditNode=function(s){var as=s.split(","),r,pi,ii,re=/[a-zA-Z0-9]+_([0-9]+)_([0-9]+)/;_STNS.UI.CUIEditMenu.fbOnClearAll.call(this);for(var i=0;i<as.length;i++){if(r=re.exec(as[i])){pi=r[1];ii=r[2];if(this.aPopups[pi]&&this.aPopups[pi].aItems[ii]){this.aPopups[pi].aItems[ii].fbSelectX(i?6:4);if(this.aPopups[pi].aItems[ii].oSubPopup){this.aPopups[pi].aItems[ii].fbShowSub(i?6:4);}}}}};CUIEditMenu.fbShowInBox=function(){var e=_STNS.fdmGetElebyId(this.sUid+"_inbox");if(e){e.style.visibility="visible";}};CUIEditMenu.fbHideInBox=function(){var e=_STNS.fdmGetEleById(this.sUid+"_inbox");if(e){e.style.visibility="hidden";}var o=_STNS.fdmGetEleById(this.oFocus.sUid+"_lnk");if(o){var rs=this.fsGetInBoxValue();if(rs===0){}else{this.oEdit.sFTxt=rs;this.oEdit.sTxt=!this.oEdit.iTyp?_STNS.fsGetHTMLEnti(rs).replace(/\\r\\n/g,"<br>"):rs;if(e=_STNS.fdmGetEleById(this.oEdit.sUid+"_txt")){e.innerHTML=this.oEdit.sTxt;}this.oFocus.fbSelect();}var sp=this.oFocus.oSubPopup;if(sp){this.fvMvto(sp.faGetXY(),sp);}o.focus();}this.oParCanvas.iStat&=_STNS.UI.CUICanvas.MAXSTATE-_STNS.UI.CUICanvas.EDITING;this.oParCanvas.fbFireEnt("endediting");return true;};CUIEditMenu.fsGetInBoxValue=function(w){var e=_STNS.fdmGetEleById(this.sUid+"_inbox"),s;if(e){s=e.childNodes[0].value;if(s.length>256){return 0;}else{return s;}}return 0;};CUIEditMenu.fbOnSelectNode=function(s){var as=s.split(","),r,pi,ii,re=/[a-zA-Z0-9]+_([0-9]+)_([0-9]+)/;_STNS.UI.CUIEditMenu.fbOnClearAll.call(this);for(var i=0;i<as.length;i++){if(r=re.exec(as[i])){pi=r[1];ii=r[2];if(this.aPopups[pi]&&this.aPopups[pi].aItems[ii]){this.aPopups[pi].aItems[ii].fbSelectX(i?2:0);if(this.aPopups[pi].aItems[ii].oSubPopup){this.aPopups[pi].aItems[ii].fbShowSub(i?2:0);}}}}};_STNS.UI.CUIEditPopup=_STNS.Class(_STNS.UI.CUIPopup);CUIEditPopup.register("UI/CUIPopup>CUIEditPopup");CUIEditPopup.construct=function(){this.oTopSelect=0;with(_STNS.UI.CUIEditPopup){this.fbHide=fbHide;}};CUIEditPopup.fbHide=function(){var _r=_STNS,t,s=this.iStat&_r.UI.CUIPopup.SHOW;if(s){for(var i=0;i<this.aItems.length;i++){this.aItems[i].fbHideMarquee();}}return _r.UI.CUIPopup.fbHide.call(this);};_STNS.UI.CUIEditItem=_STNS.Class(_STNS.UI.CUIItem,_STNS.UI.CUIEditRect);CUIEditItem.register("UI/CUIItem>CUIEditItem");CUIEditItem.register("UI/CUIEditRect>CUIEditItem");CUIEditItem.construct=function(){with(_STNS.UI.CUIEditItem){this.fbInit=fbInit;this.fbSelect=fbSelect;this.fbTraceLnk=fbTraceLnk;this.fbSelectX=fbSelectX;this.fbShowMarquee=fbShowMarquee;this.fbHideMarquee=fbHideMarquee;this.fbShowSub=fbShowSub;this.fbGetEnt=fbGetEnt;this.fbEditText=fbEditText;this.fbSetMsg("CLEAR_ALL",fbOnClearAll);this.fbEnter=fbEnter;this.fbEsc=fbEsc;this.fbUp=fbUp;this.fbDown=fbDown;this.fbLeft=fbLeft;this.fbRight=fbRight;this.faItems=faItems;this.fbNxtItem=fbNxtItem;this.fbRotItem=fbRotItem;this.fbPopFirItem=fbPopFirItem;this.fbSetFocus=fbSetFocus;this.fbSetfs=fbSetfs;}};CUIEditItem.fbOnClearAll=function(){if(this.oParMenu.oEdit==this){this.oParMenu.oEdit=null;}if(this.oParMenu.oSelect[this.sUid]){delete this.oParMenu.oSelect[this.sUid];this.fbHideMarquee();}if(this.oSubPopup){this.oSubPopup.fbHide();}};CUIEditItem.fbInit=function(){var _r=_STNS,r=true,t,_ec=_r.UI.CUIEditRect;if(!(t=_r.UI.CUIItem.fbInit.call(this))){r=false;}if(!(t=_r.UI.CUIEditRect.fbCreate.call(this))){r=false;}return r;};CUIEditItem.fbShowSub=function(a){var _r=_STNS,_cp=_r.UI.CUIPopup,_ic=_r.UI.CUIItem,p=this.oParPopup,m=this.oParMenu,sk=a&_r.UI.CUIItem.SHIFTKEY,ck=a&_r.UI.CUIItem.CTRLKEY;if(!sk&&!ck){for(var i=0;i<p.aItems.length;i++){if(p.aItems[i].oSubPopup&&i!=this.iNid){p.aItems[i].oSubPopup.fbHide();p.aItems[i].fbUpDate(p.aItems[i].iStat&(_ic.MAXSTATE-_ic.MOUSEOVER_STYLE));}}}if(this.oSubPopup){this.oSubPopup.fbShow();}return true;};CUIEditItem.fbSelect=function(a){var _r=_STNS,sk=a&_r.UI.CUIItem.SHIFTKEY,ck=a&_r.UI.CUIItem.CTRLKEY,al=a&_r.UI.CUIItem.ALTKEY,m=this.oParMenu,p=this.oParPopup,ps,ti;if(ck){if(!m.oSelect[this.sUid]){m.oSelect[this.sUid]=this;if(!p.oTopSelect){p.oTopSelect=this;}else{if(this.iNid<p.oTopSelect.iNid){p.oTopSelect=this;}}this.fbShowMarquee();if(!al){this.fbFlickerMarquee();}}else{delete m.oSelect[this.sUid];if(p.oTopSelect==this){var top=0;for(var i in m.oSelect){if(m.oSelect[i]&&m.oSelect.oParPopup==p){if(!top){top=m.oSelect[i];}else{if(m.oSelect[i].iNid<top.iNid){top=m.oSelect[i];}}}}if(top){p.oTopSelect=top;}else{p.oTopSelect=0;}}this.fbHideMarquee();}}else{if(sk){if(!p.oTopSelect){p.oTopSelect=this;}else{for(var i=0;i<p.aItems.length;i++){if(this.iNid>p.oTopSelect.iNid){if(i>p.oTopSelect.iNid&&i<this.iNid){m.oSelect[p.aItems[i].sUid]=p.aItems[i];p.aItems[i].fbShowMarquee();}else{if(i!=p.oTopSelect.iNid&&i!=this.iNid&&m.oSelect[p.aItems[i].sUid]){delete m.oSelect[p.aItems[i].sUid];p.aItems[i].fbHideMarquee();}}}else{if(this.iNid<p.oTopSelect.iNid){if(i<p.oTopSelect.iNid&&i>this.iNid){m.oSelect[p.aItems[i].sUid]=p.aItems[i];p.aItems[i].fbShowMarquee();}else{if(i!=p.oTopSelect.iNid&&i!=this.iNid&&m.oSelect[p.aItems[i].sUid]){delete m.oSelect[p.aItems[i].sUid];p.aItems[i].fbHideMarquee();}}}}}}m.oSelect[this.sUid]=this;this.fbShowMarquee();if(!al){this.fbFlickerMarquee();}if(this.iNid<p.oTopSelect.iNid){p.oTopSelect=this;}}else{ps=[];for(var i in m.oSelect){if(i!=this.sUid){m.oSelect[i].fbHideMarquee();m.oSelect[i].oParPopup.oTopSelect=0;ps[m.oSelect[i].oParPopup.iNid]=1;delete m.oSelect[i];}}ps[this.oParPopup.iNid]=0;ti=this.oParPopup.oParItem;while(ti){ps[ti.oParPopup.iNid]=0;ti=ti.oParPopup.oParItem;}for(var i=ps.length;i>=0;i--){if(ps[i]==1){m.aPopups[i].fbHide();}}m.oSelect[this.sUid]=this;if(!p.oTopSelect){p.oTopSelect=this;}else{if(this.iNid<p.oTopSelect.iNid){p.oTopSelect=this;}}this.fbShowMarquee();if(!al){this.fbFlickerMarquee();}}}return true;};CUIEditItem.fbSelectX=function(a){var p=this.oParPopup;p.fbShowX();this.fbSelect(a);return true;};CUIEditItem.fbShowMarquee=function(){var _r=_STNS,e=_r.fdmGetEleById(this.sUid),pos,w,h,p=this.oParPopup,m=this.oParMenu,pi=p?p.oParItem:0,r=true,t;if(e){pos=_r.faGetElePos(e);w=_r.fiGetEleWid(e);h=_r.fiGetEleHei(e);this.fbSetMarqueeWid(w);this.fbSetMarqueeHei(h);if(this.sLnk&&this.sLnk!="#_nolink"){this.fbSetMQCursor(m.aCursors[1]);}else{this.fbSetMQCursor(m.aCursors[0]);}this.fbSetMarqueePos(pos);if(!(t=_r.UI.CUIEditRect.fbShowMarquee.call(this))){r=false;}}return true;};CUIEditItem.fbHideMarquee=function(){var _r=_STNS;_r.UI.CUIEditRect.fbHideMarquee.call(this);};CUIEditItem.fbGetEnt=function(e,o){var et=e.type||e,oid=o.id,_r=_STNS,as;with(this){switch(et){case "mouseover":if(oid==this.sUid+"_em"){return fbFireEnt("mouseover");}break;case "mouseout":if(oid==this.sUid+"_em"){return fbFireEnt("mouseout");}break;case "click":as=0;if(e.shiftKey){as|=1;}if(e.ctrlKey){as|=2;}if(e.altKey){as|=4;}as|=8;if(oid==this.sUid+"_em"){return fbFireEnt("click");}break;case "mousedown":as=0;if(e.shiftKey){as|=1;}if(e.ctrlKey){as|=2;}if(e.altKey){as|=4;}as|=e.button*8;return fbFireEnt("mousedown",as);case "keydown":switch(e.keyCode){case 13:return fbFireEnt("pressEnter");case 37:return fbFireEnt("pressLeft");case 38:return fbFireEnt("pressUp");case 39:return fbFireEnt("pressRight");case 40:return fbFireEnt("pressDown");}break;}}return _STNS.UI.CUIItem.fbGetEnt.call(this,e,o);};CUIEditItem.fbTraceLnk=function(a){var ck=a&_STNS.UI.CUIItem.CTRLKEY,al=a&_STNS.UI.CUIItem.ALTKEY;if(ck&&al){window.open(this._sTLnk,"_blank");}return false;};CUIEditItem.fbEditText=function(){if(this.iTyp>1){return false;}var e;this.fbSelect();if(e=_STNS.fdmGetEleById(this.oParMenu.sUid+"_inbox")){var i=_STNS.fdmGetEleById(this.sUid+"_cnt"),a=_STNS.faGetElePos(i),w=_STNS.fiGetEleWid(i),h=_STNS.fiGetEleHei(i);e.style.left=(a[0]-5)+"px";if(h>34){e.style.top=(a[1]+Math.floor(h/2)-17)+"px";}else{e.style.top=(a[1]-5)+"px";}if(w<100){w=100;}e.style.width=w+"px";e.childNodes[0].style.width=w+"px";e.style.visibility="visible";e.childNodes[0].value=this.sFTxt;e.childNodes[0].select();this.oParCanvas.iStat|=_STNS.UI.CUICanvas.EDITING;this.oParCanvas.fbFireEnt("startediting");this.oParMenu.oEdit=this;}return true;};CUIEditItem.fbEnter=function(){this.fbEditText();return false;};CUIEditItem.fbEsc=function(){var _r=_STNS,o=this,m=o.oParMenu,s=o.oSubPopup,p=o.oParPopup,pi=p.oParItem,dp=p.iDepth;if(s&&(s.iStat&_r.UI.CUIPopup.SHOW)){s.fbHide();return true;}if(dp){o.fbFireEnt("mouseout");p.fbHide();pi.fbFireEnt("mouseover");pi.fbFireEnt("mousedown",8);pi.fbSetfs();}else{o.fbHideMarquee();o.fbFireEnt("mouseout");_r.fdmGetEleById(o.sUid+"_lnk").blur();}};CUIEditItem.fbUp=function(){var _r=_STNS,o=this,m=o.oParMenu,p=o.oParPopup,pi=p.oParItem,dp=p.iDepth,v=p.iTyp&_STNS.UI.CUIPopup.VERTICAL;if(m.iClk&&(m.iClk!=2)&&!m.bClked){return false;}var a=o.faItems();if(a[2]==1&&dp>1){o.fbFireEnt("mouseout");pi.fbFireEnt("mouseover");pi.fbFireEnt("mousedown",8);pi.fbSetfs();if(p.iStat&_r.UI.CUIPopup.SHOW){p.fbHide();}}else{if(v){var nI=o.fbNxtItem(0);if(nI!=o){o.fbFireEnt("mouseout");nI.fbFireEnt("mouseover");nI.fbFireEnt("mousedown",8);nI.fbSetfs();}}else{if(o.oSubPopup&&(o.oSubPopup.iStat&_r.UI.CUIPopup.SHOW)){o.oSubPopup.fbHide();}else{if(dp){o.fbFireEnt("pressEsc");}}}}return false;};CUIEditItem.fbDown=function(){var _r=_STNS,o=this,m=o.oParMenu,p=o.oParPopup,dp=p.iDepth,v=p.iTyp&_STNS.UI.CUIPopup.VERTICAL;if(m.iClk&&(m.iClk!=2)&&!m.bClked){return false;}if(v){var a=o.faItems();if(a[2]==1){return false;}var nI=o.fbNxtItem(1);o.fbFireEnt("mouseout");nI.fbFireEnt("mouseover");nI.fbFireEnt("mousedown",8);nI.fbSetfs();}else{if(o.oSubPopup){var fI=o.fbPopFirItem();o.oSubPopup.fbShow();if(fI){fI.fbFireEnt("mouseover");fI.fbFireEnt("mousedown",8);fI.fbSetfs();}}}return false;};CUIEditItem.fbLeft=function(){var _r=_STNS,o=this,m=o.oParMenu,p=o.oParPopup,pi=p.oParItem,dp=p.iDepth,v=p.iTyp&_STNS.UI.CUIPopup.VERTICAL;if(m.iClk&&(m.iClk!=2)&&!m.bClked){return false;}var a=o.faItems();if(a[2]==1&&dp>1){o.fbFireEnt("mouseout");pi.fbFireEnt("mouseover");pi.fbFireEnt("mousedown",8);pi.fbSetfs();if(p.iStat&_r.UI.CUIPopup.SHOW){p.fbHide();}}else{if(!v){var nI=o.fbNxtItem(0);if(nI!=o){o.fbFireEnt("mouseout");nI.fbFireEnt("mouseover");nI.fbFireEnt("mousedown",8);nI.fbSetfs();}}else{if(o.oSubPopup&&(o.oSubPopup.iStat&_r.UI.CUIPopup.SHOW)){o.oSubPopup.fbHide();}else{if(dp){o.fbFireEnt("pressEsc");}}}}return false;};CUIEditItem.fbRight=function(){var _r=_STNS,o=this,m=o.oParMenu,p=o.oParPopup,dp=p.iDepth,v=p.iTyp&_STNS.UI.CUIPopup.VERTICAL;if(m.iClk&&(m.iClk!=2)&&!m.bClked){return false;}if(!v){var a=o.faItems();if(a[2]==1){return false;}var nI=o.fbNxtItem(1);o.fbFireEnt("mouseout");nI.fbFireEnt("mouseover");nI.fbFireEnt("mousedown",8);nI.fbSetfs();}else{if(o.oSubPopup){var fI=o.fbPopFirItem();o.oSubPopup.fbShow();if(fI){fI.fbFireEnt("mouseover");fI.fbFireEnt("mousedown",8);fI.fbSetfs();}}else{var pi=p.oParItem;if(dp>1&&!pi.oParPopup.iTyp){if(pi.faItems()[2]>1){var npi=pi.fbNxtItem(1);o.fbFireEnt("mouseout");npi.fbFireEnt("mouseover");npi.fbFireEnt("mousedown",8);npi.fbSetfs();}return false;}else{if(m.aPopups[0].iTyp&_STNS.UI.CUIPopup.VERTICAL){return false;}}var rI=o.fbRotItem();if(rI.faItems()[2]>1){var nI=rI.fbNxtItem(1),fI=nI.fbPopFirItem();o.fbFireEnt("mouseout");nI.fbFireEnt("mouseover");nI.fbFireEnt("mousedown",8);nI.fbSetfs();}}}return false;};CUIEditItem.faItems=function(){var f=l=x=y=0,p=this.oParPopup;for(var i=0;i<p.aItems.length;i++){if(typeof p.aItems[i].sTxt!="undefined"){x++;}}for(var j=0;j<p.aItems.length;j++){if(typeof p.aItems[j].sTxt!="undefined"){y++;if(y==1){f=p.aItems[j];}if(y==x){l=p.aItems[j];}}}return [f,l,x];};CUIEditItem.fbNxtItem=function(n){var nI,o=this,p=o.oParPopup,a=o.faItems();if(a[2]<2){return o;}var f=a[0],l=a[1];if(n){if(o==l){nI=f;}else{for(var j=o.iNid+1;j<p.aItems.length;j++){nI=p.aItems[j];if(typeof nI.sTxt!="undefined"){break;}}}}else{if(o==f){nI=l;}else{for(var j=o.iNid-1;j>=0;j--){nI=p.aItems[j];if(typeof nI.sTxt!="undefined"){break;}}}}return nI;};CUIEditItem.fbRotItem=function(){var o=this,p=o.oParPopup,ppi=p;for(var k=0;k<p.iDepth-1;k++){ppi=ppi.oParPopup;}var P0i=ppi.oParItem;if(p.iDepth==0){P0i=o;}return P0i;};CUIEditItem.fbPopFirItem=function(){var o=this,p=o.oSubPopup;if(p){var a;for(var i=0;i<p.aItems.length;i++){if(typeof p.aItems[i].sTxt!="undefined"){return p.aItems[i];}}}return false;};CUIEditItem.fbSetFocus=function(){var o=this,m=o.oParMenu,e=m.oFocus,_r=_STNS,p=o.oParPopup,a=o.faItems(),w=o.iStat&_r.UI.CUIItem.CROSSFRAME?o.oParMenu.fdmGetTarFm():window;if(o==e){return;}if(e){if(e!=p.oParItem){e.fbFireEnt("mouseout");}}o.fbFireEnt("mouseover");o.fbSetfs();return true;};CUIEditItem.fbSetfs=function(){var o=this,m=o.oParMenu,_r=_STNS,w=o.iStat&_r.UI.CUIItem.CROSSFRAME?m.fdmGetTarFm():window;var e=_r.fdmGetEleById(o.sUid+"_lnk",w);if(e){m.oFocus=o;e.focus();}};_STNS.UI.CUIEditSeparator=_STNS.Class(_STNS.UI.CUISeparator,_STNS.UI.CUIEditRect);CUIEditSeparator.register("UI/CUISeparator>CUIEditSeparator");CUIEditSeparator.register("UI/CUIEditRect>CUIEditSeparator");CUIEditSeparator.construct=function(){with(_STNS.UI.CUIEditSeparator){this.fbShowMarquee=fbShowMarquee;this.fbGetEnt=fbGetEnt;this.fbSelect=fbSelect;this.fbSelectX=fbSelectX;this.fbInit=fbInit;this.fbSetMsg("CLEAR_ALL",fbOnClearAll);}};CUIEditSeparator.fbOnClearAll=function(){if(this.oParMenu.oSelect[this.sUid]){delete this.oParMenu.oSelect[this.sUid];this.fbHideMarquee();}};CUIEditSeparator.fbSelectX=CUIEditItem.fbSelectX;CUIEditSeparator.fbInit=function(){var _r=_STNS,r=true,t,_ec=_r.UI.CUIEditRect;if(!(t=_r.UI.CUISeparator.fbInit.call(this))){r=false;}if(!(t=_ec.fbCreate.call(this))){r=false;}return r;};CUIEditSeparator.fbSelect=CUIEditItem.fbSelect;CUIEditSeparator.fbShowMarquee=function(){var _r=_STNS,e=_r.fdmGetEleById(this.sUid),pos,w,h,p=this.oParPopup,pi=p?p.oParItem:0,r=true,t;if(e){pos=_r.faGetElePos(e);w=_r.fiGetEleWid(e);h=_r.fiGetEleHei(e);this.fbSetMarqueeWid(w);this.fbSetMarqueeHei(h);this.fbSetMarqueePos(pos);if(!(t=_r.UI.CUIEditRect.fbShowMarquee.call(this))){r=false;}}return true;};CUIEditSeparator.fbGetEnt=function(e,o){var et=e.type||e,oid=o.id,_r=_STNS,_c=_r.UI.CUIEditSeparator;with(this){switch(et){case "click":var as=0;if(e.shiftKey){as|=1;}if(e.ctrlKey){as|=2;}if(e.altKey){as|=4;}return fbFireEnt("click",as);case "mousedown":var as=0;if(e.shiftKey){as|=1;}if(e.ctrlKey){as|=2;}if(e.altKey){as|=4;}return fbFireEnt("mousedown",as);}}};}}_STNS._STCanvas=new _STNS.UI.CUICanvas();_STNS._STCanvas.fbInit();if(!_STNS._aStMenus){_STNS._aStMenus=[];}function stem_bm(a){STM_FILTER=0;STM_SCROLL=0;var m=stm_bm(a);m.toConvert(_STNS.UI.CUIEditMenu);m.iClk=0;m.bCfm=0;m.oParCanvas=_STNS._STCanvas;if(m.iTyp){m.iTyp=1;if(isNaN(m.iX)){m.iX=eval(m.iX);}if(isNaN(m.iY)){m.iY=eval(m.iY);}m.bCfm=0;}m.fbAttachEnt("blurinbox",m.fbHideInBox);m.fbAttachEnt("enterinbox",m.fbHideInBox);return m;}function stem_bp(id,a,pid){var p=stm_bp(id,a,pid);p.toConvert(_STNS.UI.CUIEditPopup);p.fbDetachAll();return p;}function stem_bpx(id,pid,a){return stem_bp(id,a,pid);}function stem_ai(id,a,wid,hei,pid){var it=stm_ai(id,a,wid,hei,pid);with(it){if(it.instanceOf(_STNS.UI.CUISeparator)){toConvert(_STNS.UI.CUIEditSeparator);fbDetachAll();fbAttachEnt("mousedown",fbSelect);}else{toConvert(_STNS.UI.CUIEditItem);fbDetachAll();fbAttachEnt("mouseover",fbSetOver);fbAttachEnt("mouseover",fbSetStatus);fbAttachEnt("mouseoverlink",fbSetStatus);fbAttachEnt("mouseout",fbSetOut);fbAttachEnt("mouseout",fbReStatus);fbAttachEnt("mouseoutlink",fbReStatus);fbAttachEnt("mousedown",fbShowSub);fbAttachEnt("mousedown",fbSelect);fbAttachEnt("mousedown",fbTraceLnk);fbAttachEnt("click",_STNS.fbFalse);fbAttachEnt("dblclick",_STNS.fbTrue);fbAttachEnt("dblclick",fbEditText);fbAttachEnt("keydown",_STNS.fbTrue);fbAttachEnt("mousedown",fbSetFocus);fbAttachEnt("pressEnter",fbEnter);fbAttachEnt("pressEsc",fbEsc);fbAttachEnt("pressUp",fbUp);fbAttachEnt("pressDown",fbDown);fbAttachEnt("pressLeft",fbLeft);fbAttachEnt("pressRight",fbRight);}}_STNS._STCanvas.fbInsItem(it);return it;}function stem_aix(id,pid,a,wid,hei){return stem_ai(id,a,wid,hei,pid);}function stem_ep(){stm_ep();}function stem_em(){stm_em();}